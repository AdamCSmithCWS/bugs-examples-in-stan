[
["resistant-outlier-resistant-regression-via-the-t-distribution.html", "6 Resistant: Outlier-resistant regression via the t distribution", " 6 Resistant: Outlier-resistant regression via the t distribution library(&quot;tidyverse&quot;) library(&quot;rstan&quot;) Outlying data points can distort estimates of location, such as means or regression coefficients. Location estimates obtained via maximizing a iid normal likelihood over heavy tailed data will be sensitive to data in the tails (outliers). A popular alternative to normal errors in regression analyses is the Student’s \\(t\\) density, with an unknown degrees of freedom parameter. For low degrees of freedom, the t has heavier tails than the normal, but tends to the normal as the degrees of freedom parameter increases. Treating the degrees of freedom parameter as an unknown parameter to be estimaetd thus provides a check on the appropriateness of the normal. By embedding a model with location parameters in the Student’s \\(t\\) density, we obtain outlier-resistant estimates of location parameters. To illustrate these ideas, I use data collected by Douglas Grob on incumbency advantage in American congressional elections, 1956-1994. The dependent variable is the proportion of the two-party vote won by the Democratic candidate in district \\(i\\) at election \\(t\\) (uncontested districts are dropped from the analysis). Indicators for Democratic and Republican incumbency are the critical explanatory variables in the analysis; coefficients on these indicators are regarded as estimates of incumbency advantage. A series of year-specific indicators (“fixed effects”) are also included in the specification. \\[ \\begin{aligned}[t] y_i &amp;\\sim \\mathsf{StudentT}(\\nu, \\mu_i, \\sigma) \\\\ \\mu_i &amp;= \\alpha + x_i \\beta \\end{aligned} \\] The \\(\\alpha\\), \\(\\beta\\), and \\(\\sigma\\) parameters are given weakly informative priors (assuming that all \\(x\\) are scaled to have mean 0, standard deviation 1): \\[ \\begin{aligned}[t] \\alpha &amp;\\sim \\mathsf{Normal}(\\bar{y}, 10 s_y), \\\\ \\beta &amp;\\sim \\mathsf{Normal}(0, 2.5 s_y), \\\\ \\sigma &amp;\\sim \\mathsf{HalfCauchy}(0, 5 s_y) , \\end{aligned} \\] where \\(\\bar{y}\\) is the mean of \\(y\\), and \\(s_y\\) is the standard deviation of \\(y\\). The degrees of freedom parameter in the Student-t distribution is a paramter and given the weakly informative prior suggested by Juárez and Steel (2010), \\[ \\nu \\sim \\mathsf{Gamma}(2, 0.1) . \\] The following code operationalizes this regression model; the conditional density of the vote proportions is \\(t\\), with unknown degrees of freedom, \\(\\nu.\\) resistant_mod &lt;- stan_model(&quot;stan/resistant.stan&quot;) data { int N; vector[N] y; int K; matrix[N, K] X; int Y; int year[N]; // priors real sigma_scale; vector[K] beta_loc; vector[K] beta_scale; real gamma_loc; real gamma_scale; real tau_scale; } parameters { vector[Y] alpha; vector[K] beta; real nu; real sigma; real gamma; real tau; } transformed parameters { vector[N] mu; for (i in 1:N) { mu[i] = alpha[year[i]] + X[i] * beta; } } model{ // priors for error variance sigma ~ cauchy(0., sigma_scale); // priors for year intercepts alpha ~ normal(gamma, tau); gamma ~ normal(gamma_loc, gamma_scale); tau ~ cauchy(0., tau_scale); // priors for the regression coefficients beta ~ normal(beta_loc, beta_scale); // degrees of freedom nu ~ gamma(2, 0.1); // likelihood y ~ student_t(nu, mu, sigma); } generated quantities { real delta; delta = beta[3] + beta[4]; } load(&quot;data/resistant.rda&quot;) resistant_data &lt;- within(list(), { y &lt;- resistant$y N &lt;- length(y) X &lt;- model.matrix(~ 0 + lagy + prvwinpty + deminc + repinc, data = resistant) %&gt;% scale() K &lt;- ncol(X) year &lt;- resistant$year Y &lt;- max(year) # priors alpha_loc &lt;- mean(y) alpha_scale &lt;- 10 * sd(y) beta_loc &lt;- rep(0, K) beta_scale &lt;- rep(2.5 * sd(y), K) sigma_scale &lt;- 5 * sd(y) }) resistant_fit &lt;- sampling(resistant_mod, data = resistant_data) #&gt; Warning in is.na(x): is.na() applied to non-(list or vector) of type &#39;NULL&#39; #&gt; Warning in FUN(X[[i]], ...): data with name gamma_loc is not numeric and #&gt; not used #&gt; Warning in is.na(x): is.na() applied to non-(list or vector) of type &#39;NULL&#39; #&gt; Warning in FUN(X[[i]], ...): data with name gamma_scale is not numeric and #&gt; not used #&gt; Warning in is.na(x): is.na() applied to non-(list or vector) of type &#39;NULL&#39; #&gt; Warning in FUN(X[[i]], ...): data with name tau_scale is not numeric and #&gt; not used #&gt; failed to create the sampler; sampling not done summary(resistant_fit, par = c(&quot;nu&quot;, &quot;sigma&quot;, &quot;beta&quot;, &quot;tau&quot;))$summary #&gt; Stan model &#39;resistant&#39; does not contain samples. #&gt; NULL References "]
]
