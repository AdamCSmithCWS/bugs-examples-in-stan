<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bayesian Model Examples</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Bayesian Model Examples">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Bayesian Model Examples" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Model Examples" />
  
  
  

<meta name="author" content="Jeffrey B. Arnold and Simon Jackman">


<meta name="date" content="2017-05-31">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="turnout.html">
<link rel="next" href="reagan.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="undervote.html"><a href="undervote.html"><i class="fa fa-check"></i><b>1</b> Undervoting for President, by Race: difference in two binomial proportions</a></li>
<li class="chapter" data-level="2" data-path="cancer.html"><a href="cancer.html"><i class="fa fa-check"></i><b>2</b> Cancer: difference in two binomial proportions</a></li>
<li class="chapter" data-level="3" data-path="florida.html"><a href="florida.html"><i class="fa fa-check"></i><b>3</b> Florida: Learning About an Unknown Proportion from Survey Data</a></li>
<li class="chapter" data-level="4" data-path="turnout.html"><a href="turnout.html"><i class="fa fa-check"></i><b>4</b> Turnout: logit/probit models for binary data</a><ul>
<li class="chapter" data-level="" data-path="turnout.html"><a href="turnout.html#questions"><i class="fa fa-check"></i>Questions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cosponsorship.html"><a href="cosponsorship.html"><i class="fa fa-check"></i><b>5</b> Cosponsorship: computing auxiliary quantities from MCMC output</a></li>
<li class="chapter" data-level="6" data-path="reagan.html"><a href="reagan.html"><i class="fa fa-check"></i><b>6</b> Reagan: linear regression with AR(1) disturbances</a></li>
<li class="chapter" data-level="7" data-path="sophistication.html"><a href="sophistication.html"><i class="fa fa-check"></i><b>7</b> Political Sophistication: item-response modeling with mixed data types</a></li>
<li class="chapter" data-level="8" data-path="legislators.html"><a href="legislators.html"><i class="fa fa-check"></i><b>8</b> Legislators: estimating legislators’ ideal points from voting histories (roll call data)</a></li>
<li class="chapter" data-level="9" data-path="judges.html"><a href="judges.html"><i class="fa fa-check"></i><b>9</b> Judges: estimating the ideological locations of Supreme Court justices</a></li>
<li class="chapter" data-level="10" data-path="resistant-outlier-resistant-regression-via-the-students-t-distribution-resistant.html"><a href="resistant-outlier-resistant-regression-via-the-students-t-distribution-resistant.html"><i class="fa fa-check"></i><b>10</b> Resistant: Outlier-resistant regression via the Student’s <span class="math inline">\(t\)</span> distribution (#resistant)</a><ul>
<li class="chapter" data-level="" data-path="resistant-outlier-resistant-regression-via-the-students-t-distribution-resistant.html"><a href="resistant-outlier-resistant-regression-via-the-students-t-distribution-resistant.html#questions-1"><i class="fa fa-check"></i>Questions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="uk92.html"><a href="uk92.html"><i class="fa fa-check"></i><b>11</b> House of Commons elections: modeling with the multivariate t density</a></li>
<li class="chapter" data-level="12" data-path="campaign.html"><a href="campaign.html"><i class="fa fa-check"></i><b>12</b> Pooling the Polls Over an Election Campaign</a></li>
<li class="chapter" data-level="13" data-path="aspirin-shrinkage-or-borrowing-strength-via-hierarchical-modeling-aspirin.html"><a href="aspirin-shrinkage-or-borrowing-strength-via-hierarchical-modeling-aspirin.html"><i class="fa fa-check"></i><b>13</b> Aspirin: Shrinkage (or “borrowing strength”) via hierarchical modeling (aspirin)</a><ul>
<li class="chapter" data-level="13.1" data-path="aspirin-shrinkage-or-borrowing-strength-via-hierarchical-modeling-aspirin.html"><a href="aspirin-shrinkage-or-borrowing-strength-via-hierarchical-modeling-aspirin.html#data"><i class="fa fa-check"></i><b>13.1</b> data</a></li>
<li class="chapter" data-level="13.2" data-path="aspirin-shrinkage-or-borrowing-strength-via-hierarchical-modeling-aspirin.html"><a href="aspirin-shrinkage-or-borrowing-strength-via-hierarchical-modeling-aspirin.html#initial-values"><i class="fa fa-check"></i><b>13.2</b> initial values</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="corporatism.html"><a href="corporatism.html"><i class="fa fa-check"></i><b>14</b> “Corporatism: hierarchical or”multi-level&quot; model for economic growth in 16 OECD countries&quot;</a></li>
<li class="chapter" data-level="15" data-path="bimodal.html"><a href="bimodal.html"><i class="fa fa-check"></i><b>15</b> Bimodal: Extreme missingness in bivariate normal data</a></li>
<li class="chapter" data-level="16" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html"><i class="fa fa-check"></i><b>16</b> Engines: right-censored failure times</a></li>
<li class="chapter" data-level="17" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html"><i class="fa fa-check"></i><b>17</b> Truncation: How does Stan deal with truncation?</a></li>
<li class="chapter" data-level="18" data-path="genbeetles.html"><a href="genbeetles.html"><i class="fa fa-check"></i><b>18</b> Generalized Beetles: generalizing link functions for binomial GLMs</a></li>
<li class="chapter" data-level="19" data-path="negbin.html"><a href="negbin.html"><i class="fa fa-check"></i><b>19</b> Negative Binomial: Estimating Homicides in Census Tracks</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Model Examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cosponsorship" class="section level1">
<h1><span class="header-section-number">5</span> Cosponsorship: computing auxiliary quantities from MCMC output</h1>
<p>Typically, MCMC output consists of samples from the posterior density of model parameters. But note that other quantities can be generated as well, say, imputations for missing data points, predictions, residuals, or goodness-of-fit summary statistics. In fact, any function of the parameters can be calculated and output.</p>
<p>I demonstrate these ideas in the context of a generalized linear model for binary data. The specific application is <span class="citation">Krehbiel (<a href="#ref-Krehbiel1995a">1995</a>)</span>, a study of legislative behavior. The dependent variable is a binary indicator, coded 1 if members of the U.S. House of Representatives chose to cosponsor bill HR 3266, and 0 otherwise (228 legislators cosponsored HR 3266, out of the 434 legislators for which data is available). HR3266 was a wide-ranging spending bill designed to circumvent the usual budget-making process, that was considered by the 103rd House of Representatives in 1993/94. Seven covariates are used in the analysis: a measure of each member’s liberalism as measured by the interest group Americans for Democratic Action (ADA), a measure of fiscal conservatism published by the National Taxpayers’ Union (NTU), an indicator variable for Democratic Party membership, a measure of Congressional seniority (years since first election, and thus inversely proportional to seniority), the electoral margin of the member, an indicator for membership of the House Appropriations Committee, and an indicator for membership of the House Budget Committee. <span class="citation">Krehbiel (<a href="#ref-Krehbiel1995a">1995</a>)</span> multivariate analysis finds that after controlling for legislators’ policy preferences (as measured with the ADA and NTU scores), Democrats were actually more likely to support H.R. 3266 than Republicans. Seniority is also a key predictor, with junior members more likely to cosponsor this legislation than members with greater seniority.</p>
<p>Several auxiliary quantities are estimated in the following BUGS program. Percent-correctly-predicted (PCP) and a related quantity (expected PCP, or ePCP; see <span class="citation">Herron (<a href="#ref-Herron1999a">1999</a>)</span>) are easily coded using the BUGS “equals” and “step” constructs. <span class="citation">Herron (<a href="#ref-Herron1999a">1999</a>)</span> also investigated the effect sizes of certain key predictors, by holding other covariates at fixed values and then comparing the predicted probabilities under various hypothetical scenarios. Again, these are easily programmed and computed in WinBUGS; uncertainty in these quantities follows from the uncertainty in the parameters, and it is extremely easy to use WinBUGS to produce samples from the posterior density of these quantities.</p>
<p>I also compute latent residuals <span class="citation">(Gelman et al. <a href="#ref-GelmanGoegebeurTuerlinckxEtAl2000a">2000</a>; J. Albert and Chib <a href="#ref-AlbertChib1995a">1995</a>)</span>. These quantities are simply the difference between the latent y* and their fitted values. In a typical logit or probit analysis, y* is completely ignored by the analyst. But for Bayesian simulation, y* is central to the recovery of the parameters themselves: recall that Bayesian simulation in this context largely amounts to treating the y* as missing data. Hence not only are the y* recovered, but with very little additional effort we can also recover the latent residuals, at each iteration t. Moreover, these latent residuals have uncertainty associated with them, stemming from uncertainty in b, and so we recover not just point estimates but their posterior densities.</p>
<p><span class="math display">\[
\begin{aligned}[t]
y_i &amp;= \mathsf{Bernoulli}(\mu_i) \\
\mu_i &amp;= \mathsf{Logit}^{-1}(x_i \beta)
\end{aligned}
\]</span></p>
<p>model{ for (i in 1:N){ # loop over observations mu[i] &lt;- beta[1] + beta[2]<em>ada[i] + beta[3]</em>ntu[i] + beta[4]<em>dem[i] + beta[5]</em>frosh[i] + beta[6]<em>margin[i] + beta[7]</em>approp[i] + beta[8]*budget[i];</p>
<pre><code>    ystar[i] ~ dnorm(mu[i],1)I(lo[y[i]+1], up[y[i]+1]);  # trunc Normal

    ## auxiliary quantities, individual specific
    e[i] &lt;-  ystar[i] - mu[i];        # latent residuals
    probit(p[i]) &lt;- mu[i];            # predicted probs

    ## goodness of fit summaries
    llh[i] &lt;- (equals(y[i],1)*log(p[i])) + (equals(y[i],0)*log(1-p[i]));
    epcp[i] &lt;- (equals(y[i],1)*p[i]) + (equals(y[i],0)*(1-p[i]));
    pcp[i] &lt;- equals(y[i],1)*step(p[i]-.5)
            + equals(y[i],0)*step(.5-p[i]);
}

## aggregate auxiliary quantities
sumllh &lt;- sum(llh[]);     # sum likelihood contributions
PCP &lt;- sum(pcp[])/N;      # sum pcp contributions

## clarify calculations</code></pre>
<p>## probability of co-sponsorship for “average” member (median x vals) probit(pbar) &lt;- beta[1] + beta[2]<em>0.55 + beta[3]</em>0.32 + beta[4] + beta[5]<em>86 + beta[6]</em>0.26;</p>
<pre><code>## party affiliation, effect size
probit(p.dem) &lt;- beta[1] + beta[2]*0.55 + beta[3]*0.32
               + beta[4] + beta[5]*86 + beta[6]*0.26;</code></pre>
<p>probit(p.rep) &lt;- beta[1] + beta[2]<em>0.55 + beta[3]</em>0.32 + beta[5]<em>86 + beta[6]</em>0.26; d.party &lt;- p.dem - p.rep;</p>
<p>## “attributable effect”, all sources, due to party affiliation probit(p.dem.all) &lt;- beta[1] + beta[2]<em>0.8 + beta[3]</em>0.2 + beta[4] + beta[5]<em>86 + beta[6]</em>0.28; probit(p.rep.all) &lt;- beta[1] + beta[2]<em>0.1 + beta[3]</em>0.74 + beta[5]<em>86 + beta[6]</em>0.24; d.party.all &lt;- p.dem.all - p.rep.all</p>
<p>## bounds for truncated normal sampling lo[1] &lt;- -50; lo[2] &lt;- 0; up[1] &lt;- 0; up[2] &lt;- 50;</p>
<pre><code>## priors, multivariate normal, mean and precision in data file
beta[1:k] ~ dmnorm(b0[ ] , B0[ , ]);</code></pre>
<p>}</p>
<p>Initial Values (MLEs): list(beta=c(-7.94, -.74, 8.82, 1.00, .052, -.051, -.24, -.858))</p>

</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Krehbiel1995a">
<p>Krehbiel, Keith. 1995. “Cosponsors and Wafflers from a to Z.” <em>American Journal of Political Science</em> 39 (4). JSTOR: 906. doi:<a href="https://doi.org/10.2307/2111662">10.2307/2111662</a>.</p>
</div>
<div id="ref-Herron1999a">
<p>Herron, Michael C. 1999. “Postestimation Uncertainty in Limited Dependent Variable Models.” <em>Political Analysis</em> 8 (01). Cambridge University Press (CUP): 83–98. doi:<a href="https://doi.org/10.1093/oxfordjournals.pan.a029806">10.1093/oxfordjournals.pan.a029806</a>.</p>
</div>
<div id="ref-GelmanGoegebeurTuerlinckxEtAl2000a">
<p>Gelman, A., Y. Goegebeur, F. Tuerlinckx, and I. Van Mechelen. 2000. “Diagnostic Checks for Discrete Data Regression Models Using Posterior Predictive Simulations.” <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 49 (2). Wiley-Blackwell: 247–68. doi:<a href="https://doi.org/10.1111/1467-9876.00190">10.1111/1467-9876.00190</a>.</p>
</div>
<div id="ref-AlbertChib1995a">
<p>Albert, Jim, and Siddhartha Chib. 1995. “Bayesian Residual Analysis for Binary Response Regression Models.” <em>Biometrika</em> 82 (4). Oxford University Press (OUP): 747–69. doi:<a href="https://doi.org/10.1093/biomet/82.4.747">10.1093/biomet/82.4.747</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="turnout.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reagan.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
