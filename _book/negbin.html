<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bayesian Model Examples</title>
  <meta name="description" content="Bayesian Model Examples">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Bayesian Model Examples" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Model Examples" />
  
  
  

<meta name="author" content="Jeffrey B. Arnold and Simon Jackman">


<meta name="date" content="2017-06-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="genbeetles.html">
<link rel="next" href="multivarmissing.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="undervote.html"><a href="undervote.html"><i class="fa fa-check"></i><b>1</b> Undervoting for President, by Race: difference in two binomial proportions</a></li>
<li class="chapter" data-level="2" data-path="cancer.html"><a href="cancer.html"><i class="fa fa-check"></i><b>2</b> Cancer: difference in two binomial proportions</a></li>
<li class="chapter" data-level="3" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html"><i class="fa fa-check"></i><b>3</b> A tibble: 2 x 3</a><ul>
<li class="chapter" data-level="3.1" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html#two-sample-binomial-model"><i class="fa fa-check"></i><b>3.1</b> Two Sample Binomial Model</a></li>
<li class="chapter" data-level="3.2" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html#binomial-logit-model-of-the-difference"><i class="fa fa-check"></i><b>3.2</b> Binomial Logit Model of the Difference</a></li>
<li class="chapter" data-level="3.3" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html#questions"><i class="fa fa-check"></i><b>3.3</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="florida.html"><a href="florida.html"><i class="fa fa-check"></i><b>4</b> Florida: Learning About an Unknown Proportion from Survey Data</a></li>
<li class="chapter" data-level="5" data-path="turnout.html"><a href="turnout.html"><i class="fa fa-check"></i><b>5</b> Turnout: logit/probit models for binary data</a><ul>
<li class="chapter" data-level="5.1" data-path="turnout.html"><a href="turnout.html#datas"><i class="fa fa-check"></i><b>5.1</b> Datas</a></li>
<li class="chapter" data-level="5.2" data-path="turnout.html"><a href="turnout.html#logit-model"><i class="fa fa-check"></i><b>5.2</b> Logit Model</a></li>
<li class="chapter" data-level="5.3" data-path="turnout.html"><a href="turnout.html#probit-model"><i class="fa fa-check"></i><b>5.3</b> Probit Model</a></li>
<li class="chapter" data-level="5.4" data-path="turnout.html"><a href="turnout.html#rstanarm"><i class="fa fa-check"></i><b>5.4</b> rstanarm</a></li>
<li class="chapter" data-level="" data-path="turnout.html"><a href="turnout.html#questions-1"><i class="fa fa-check"></i>Questions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cosponsorship.html"><a href="cosponsorship.html"><i class="fa fa-check"></i><b>6</b> Cosponsorship: computing auxiliary quantities from MCMC output</a><ul>
<li class="chapter" data-level="6.1" data-path="cosponsorship.html"><a href="cosponsorship.html#model"><i class="fa fa-check"></i><b>6.1</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reagan.html"><a href="reagan.html"><i class="fa fa-check"></i><b>7</b> Reagan: linear regression with AR(1) disturbances</a><ul>
<li class="chapter" data-level="7.1" data-path="reagan.html"><a href="reagan.html#cochrane-orcuttprais-winsten"><i class="fa fa-check"></i><b>7.1</b> Cochrane-Orcutt/Prais-Winsten</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sophistication.html"><a href="sophistication.html"><i class="fa fa-check"></i><b>8</b> Political Sophistication: item-response modeling with mixed data types</a><ul>
<li class="chapter" data-level="8.1" data-path="sophistication.html"><a href="sophistication.html#data"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="sophistication.html"><a href="sophistication.html#model-1"><i class="fa fa-check"></i><b>8.2</b> Model</a></li>
<li class="chapter" data-level="8.3" data-path="sophistication.html"><a href="sophistication.html#estimation"><i class="fa fa-check"></i><b>8.3</b> Estimation</a></li>
<li class="chapter" data-level="8.4" data-path="sophistication.html"><a href="sophistication.html#questions-extensions"><i class="fa fa-check"></i><b>8.4</b> Questions / Extensions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="legislators.html"><a href="legislators.html"><i class="fa fa-check"></i><b>9</b> Legislators: estimating legislators’ ideal points from voting histories (roll call data)</a><ul>
<li class="chapter" data-level="9.1" data-path="legislators.html"><a href="legislators.html#identification"><i class="fa fa-check"></i><b>9.1</b> Identification</a></li>
<li class="chapter" data-level="9.2" data-path="legislators.html"><a href="legislators.html#th-senate"><i class="fa fa-check"></i><b>9.2</b> 109th Senate</a></li>
<li class="chapter" data-level="9.3" data-path="legislators.html"><a href="legislators.html#identification-by-fixing-legislators-ideal-points"><i class="fa fa-check"></i><b>9.3</b> Identification by Fixing Legislator’s Ideal Points</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="identification-by-fixing-legislators-signs.html"><a href="identification-by-fixing-legislators-signs.html"><i class="fa fa-check"></i><b>10</b> Identification by fixing Legislator’s Signs</a><ul>
<li class="chapter" data-level="10.1" data-path="identification-by-fixing-legislators-signs.html"><a href="identification-by-fixing-legislators-signs.html#questions-2"><i class="fa fa-check"></i><b>10.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="judges.html"><a href="judges.html"><i class="fa fa-check"></i><b>11</b> Judges: estimating the ideological locations of Supreme Court justices</a></li>
<li class="chapter" data-level="12" data-path="resistant.html"><a href="resistant.html"><i class="fa fa-check"></i><b>12</b> Resistant: Outlier-resistant regression via the Student’s <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="12.1" data-path="resistant.html"><a href="resistant.html#data-1"><i class="fa fa-check"></i><b>12.1</b> Data</a></li>
<li class="chapter" data-level="" data-path="resistant.html"><a href="resistant.html#questions-3"><i class="fa fa-check"></i>Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="uk92.html"><a href="uk92.html"><i class="fa fa-check"></i><b>13</b> House of Commons elections: modeling with the multivariate Student-<span class="math inline">\(t\)</span> density</a><ul>
<li class="chapter" data-level="13.1" data-path="uk92.html"><a href="uk92.html#questions-4"><i class="fa fa-check"></i><b>13.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="campaign.html"><a href="campaign.html"><i class="fa fa-check"></i><b>14</b> Pooling the Polls Over an Election Campaign</a><ul>
<li class="chapter" data-level="14.1" data-path="campaign.html"><a href="campaign.html#data-2"><i class="fa fa-check"></i><b>14.1</b> Data</a></li>
<li class="chapter" data-level="14.2" data-path="campaign.html"><a href="campaign.html#model-2"><i class="fa fa-check"></i><b>14.2</b> Model</a></li>
<li class="chapter" data-level="14.3" data-path="campaign.html"><a href="campaign.html#estimation-1"><i class="fa fa-check"></i><b>14.3</b> Estimation</a></li>
<li class="chapter" data-level="14.4" data-path="campaign.html"><a href="campaign.html#questions-5"><i class="fa fa-check"></i><b>14.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="aspirin.html"><a href="aspirin.html"><i class="fa fa-check"></i><b>15</b> Aspirin: Borrowing Strength via Hierarchical Modeling</a><ul>
<li class="chapter" data-level="15.1" data-path="aspirin.html"><a href="aspirin.html#non-centered-parameterization"><i class="fa fa-check"></i><b>15.1</b> Non-centered parameterization</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="corporatism.html"><a href="corporatism.html"><i class="fa fa-check"></i><b>16</b> Corporatism: Hierarchical model for economic growth</a></li>
<li class="chapter" data-level="17" data-path="unidentified.html"><a href="unidentified.html"><i class="fa fa-check"></i><b>17</b> Unidentified: over-parameterization of normal mean</a></li>
<li class="chapter" data-level="18" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html"><i class="fa fa-check"></i><b>18</b> Engines: right-censored failure times</a><ul>
<li class="chapter" data-level="18.1" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html#data-3"><i class="fa fa-check"></i><b>18.1</b> Data</a></li>
<li class="chapter" data-level="18.2" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html#model-3"><i class="fa fa-check"></i><b>18.2</b> Model</a></li>
<li class="chapter" data-level="18.3" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html#estimation-2"><i class="fa fa-check"></i><b>18.3</b> Estimation</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html"><i class="fa fa-check"></i><b>19</b> Truncation: How does Stan deal with truncation?</a><ul>
<li class="chapter" data-level="19.1" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html#stan-model"><i class="fa fa-check"></i><b>19.1</b> Stan Model</a></li>
<li class="chapter" data-level="19.2" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html#estimation-3"><i class="fa fa-check"></i><b>19.2</b> Estimation</a></li>
<li class="chapter" data-level="19.3" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html#questions-6"><i class="fa fa-check"></i><b>19.3</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="genbeetles.html"><a href="genbeetles.html"><i class="fa fa-check"></i><b>20</b> Generalized Beetles: Generalizing Link Functions for Binomial GLMs</a><ul>
<li class="chapter" data-level="20.1" data-path="genbeetles.html"><a href="genbeetles.html#data-4"><i class="fa fa-check"></i><b>20.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="negbin.html"><a href="negbin.html"><i class="fa fa-check"></i><b>21</b> Negative Binomial: Estimating Homicides in Census Tracks</a></li>
<li class="chapter" data-level="22" data-path="multivarmissing.html"><a href="multivarmissing.html"><i class="fa fa-check"></i><b>22</b> Multivariate Missing Data</a><ul>
<li class="chapter" data-level="22.1" data-path="multivarmissing.html"><a href="multivarmissing.html#separate-regressions"><i class="fa fa-check"></i><b>22.1</b> Separate Regressions</a></li>
<li class="chapter" data-level="22.2" data-path="multivarmissing.html"><a href="multivarmissing.html#multivariate-normal"><i class="fa fa-check"></i><b>22.2</b> Multivariate Normal</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Model Examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="negbin" class="section level1">
<h1><span class="header-section-number">21</span> Negative Binomial: Estimating Homicides in Census Tracks</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;rstan&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;rstanarm&quot;</span>)</code></pre></div>
<p>The data are from the 1990 United States Census for the city of St. Louis, Missouri for Census Tracts, and from records of the St. Louis City Metropolitan Police Department for the years 1980 through 1994. For each Census Tract (with a population), N=111, an observation includes</p>
<ul>
<li>the median household income in 1990</li>
<li>the percentage unemployed (base of labor force)</li>
<li>a count of the number of homicide incidents.</li>
</ul>
<p>The number of homicides in this 15 year period totals 2,815. The average size of a Census Tract is 3,571 with a range of 249–8,791. Income has been rescaled by dividing by 1,000 which produces a range similar to that of percentage unemeployed and standard deviations that are very close. Tract homicide counts range from 0 through 99 with a median of 16 (mean is 25.+). An enhanced set of linear, predictors does better than this two predictor example.</p>
<p><span class="math display">\[
\begin{aligned}[t]
y_i &amp;\sim \mathsf{NegBinomial2}(\mu_i,\phi) \\
\mu_i &amp;= \frac{1}{1 + e^{-\eta_i}} \\
\eta_i &amp;= x_i \beta
\end{aligned}
\]</span> The negative binomial distribution is parameterized so that <span class="math inline">\(\mu \in \mathbb{R}^+\)</span> is the location parameter, and <span class="math inline">\(\phi \in \mathbb{R}^+\)</span> is the reciprocal overdisperson parameter, such that the mean and variance of a random variable <span class="math inline">\(Y\)</span> distributed negative binomial is <span class="math display">\[
\begin{aligned}[t]
E[Y] &amp;= \mu , \\
V[Y] &amp;= \mu + \frac{\mu^2}{\phi} .
\end{aligned}
\]</span> As <span class="math inline">\(\phi \to \infty\)</span>, the negative binomial approaches the Poisson distribution.</p>
<p>The parameters are given weakly informative priors, <span class="math display">\[
\begin{aligned}[t]
\alpha &amp;\sim \mathsf{Normal}(0, 10), \\
\beta_k &amp;\sim \mathsf{Normal}(0, 2.5), \\
\phi^{-1} &amp;\sim \mathsf{HalfCauchy}(0, 5).
\end{aligned}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">negbin_mod &lt;-<span class="st"> </span><span class="kw">stan_model</span>(<span class="st">&quot;stan/negbin.stan&quot;</span>)</code></pre></div>
<pre>
  <code class="stan">data {
  int N;
  int y[N];
  int K;
  matrix[N, K] X;
  // priors
  real alpha_mean;
  real<lower = 0.> alpha_scale;
  vector[K] beta_mean;
  vector<lower = 0.>[K] beta_scale;
  real<lower = 0.> reciprocal_phi_scale;
}
parameters {
  real alpha;
  vector[K] beta;
  real<lower = 0.> reciprocal_phi;
}
transformed parameters {
  vector[N] eta;
  real<lower = 0.> phi;
  eta = alpha + X * beta;
  phi = 1. / reciprocal_phi;
}
model {
  reciprocal_phi ~ cauchy(0., reciprocal_phi_scale);
  alpha ~ normal(alpha_mean, alpha_scale);
  beta ~ normal(beta_mean, beta_scale);
  y ~ neg_binomial_2_log(eta, phi);
}
generated quantities {
  vector[N] mu;
  vector[N] log_lik;
  vector[N] y_rep;
  mu = exp(eta);
  for (i in 1:N) {
    log_lik[i] = neg_binomial_2_log_lpmf(y[i] | eta[i], phi);
    y_rep[i] = neg_binomial_2_rng(mu[i], phi);
  }
}</code>
</pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;data/st_louis_census.rda&quot;</span>)
negbin_data &lt;-<span class="st"> </span><span class="kw">within</span>(<span class="kw">list</span>(), {
  y &lt;-<span class="st"> </span>st_louis_census<span class="op">$</span>i8094
  N &lt;-<span class="st"> </span><span class="kw">length</span>(y)
  X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>pcunemp9 <span class="op">+</span><span class="st"> </span>incrs, <span class="dt">data =</span> st_louis_census) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">scale</span>()
  K &lt;-<span class="st"> </span><span class="kw">ncol</span>(X)
  beta_mean &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, K)
  beta_scale &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">2.5</span>, K)  
  alpha_mean &lt;-<span class="st"> </span><span class="dv">0</span>
  alpha_scale &lt;-<span class="st"> </span><span class="dv">10</span>
  reciprocal_phi_scale &lt;-<span class="st"> </span><span class="dv">5</span>
})</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">negbin_fit &lt;-<span class="st"> </span><span class="kw">sampling</span>(negbin_mod, <span class="dt">data =</span> negbin_data)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(negbin_fit, <span class="dt">par =</span> <span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;phi&quot;</span>))<span class="op">$</span>summary
<span class="co">#&gt;           mean se_mean     sd   2.5%    25%    50%    75%  97.5% n_eff</span>
<span class="co">#&gt; alpha    2.927 0.00126 0.0722  2.786  2.879  2.925  2.975  3.070  3300</span>
<span class="co">#&gt; beta[1]  0.692 0.00193 0.1100  0.478  0.618  0.692  0.763  0.913  3253</span>
<span class="co">#&gt; beta[2] -0.347 0.00171 0.1015 -0.550 -0.414 -0.346 -0.279 -0.151  3539</span>
<span class="co">#&gt; phi      1.967 0.00584 0.3143  1.428  1.752  1.943  2.154  2.666  2894</span>
<span class="co">#&gt;          Rhat</span>
<span class="co">#&gt; alpha   1.000</span>
<span class="co">#&gt; beta[1] 1.000</span>
<span class="co">#&gt; beta[2] 0.999</span>
<span class="co">#&gt; phi     1.001</span></code></pre></div>
<p>We could also fit the model using the <strong>rstanarm</strong> function <code>stan_glm.nb</code> (or <code>stan_glm</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">negbin_fit2 &lt;-<span class="st"> </span><span class="kw">stan_glm.nb</span>(i8094 <span class="op">~</span><span class="st"> </span>pcunemp9 <span class="op">+</span><span class="st"> </span>incrs, <span class="dt">data =</span> st_louis_census)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">negbin_fit2
<span class="co">#&gt; stan_glm.nb</span>
<span class="co">#&gt;  family:  neg_binomial_2 [log]</span>
<span class="co">#&gt;  formula: i8094 ~ pcunemp9 + incrs</span>
<span class="co">#&gt; ------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates:</span>
<span class="co">#&gt;                       Median MAD_SD</span>
<span class="co">#&gt; (Intercept)            2.8    0.4  </span>
<span class="co">#&gt; pcunemp9               0.1    0.0  </span>
<span class="co">#&gt; incrs                 -0.1    0.0  </span>
<span class="co">#&gt; reciprocal_dispersion  2.0    0.3  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sample avg. posterior predictive </span>
<span class="co">#&gt; distribution of y (X = xbar):</span>
<span class="co">#&gt;          Median MAD_SD</span>
<span class="co">#&gt; mean_PPD 32.0    5.5  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ------</span>
<span class="co">#&gt; For info on the priors used see help(&#39;prior_summary.stanreg&#39;).</span></code></pre></div>
<p>Example derived from Simon Jackman, “negative binomial using the ones trick with log link”, 2005-10-27, <a href="https://web-beta.archive.org/web/20051027082311/http://jackman.stanford.edu:80/mcmc/negbineg.odc">URL</a>.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="genbeetles.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivarmissing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
