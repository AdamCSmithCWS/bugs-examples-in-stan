# Turnout: logit/probit models for binary data {#turnout}

```{r turnout_setup,message=FALSE}
library("tidyverse")
library("rstanarm")
library("rstan")
```

Voter turnout is coded as a binary indicator (`y=1` if voted, `0` otherwise) and related to covariates via a logit model.  The data comprise a random 3,000 observation subset of a much larger data set analyzed by Jonathan Nagler [@Nagler1994a]:

$$
\begin{aligned}[t]
y_i &\sim \mathsf{Bernoulli}(\pi_i) \\
\pi_i &= \frac{1}{1 + e^{-\eta_i}} \\
\eta_i &= \alpha + x_i \beta
\end{aligned}
$$
The regression parameters are given weakly informative priors on the logit scale,
$$
\begin{aligned}[t]
\alpha &\sim \mathsf{Normal}(0, 10)\\
\beta_k &\sim \mathsf{Normal}(0, 2.5)
\end{aligned}
$$
and on the probit scale,
$$
\begin{aligned}[t]
\alpha &\sim \mathsf{Normal}(0, 8) \\
\beta_k &\sim \mathsf{Normal}(0, 2)
\end{aligned}
$$

```{r turnout2005_mod_logit,results='hide',cache.extra=tools::md5sum("stan/logit.stan")}
turnout2005_mod_logit <- stan_model("stan/logit.stan")
```
```{r results='asis',echo=FALSE}
turnout2005_mod_logit
```


```{r turnout2005,cache.extra=tools::md5sum("data/turnout2005.rda")}
load("data/turnout2005.rda")
```
```{r turnout2005_data}
turnout2005_data <- within(list(), {
  N <- nrow(turnout2005)
  X <- scale(model.matrix(~ 0 + closing * poly(educ, 2) + poly(age, 2) + 
                          south + govelec, data = turnout2005))
  K <- ncol(X)
  y <- turnout2005$y
  alpha_mean <- 0
  alpha_scale <- 10
  beta_mean <- rep(0, K)
  beta_scale <- rep(2.5, K)
})
```

The only difference between and logit model and 

```{r turnout2005_mod_probit,results='hide',cache.extra=tools::md5sum("stan/probit.stan")}
turnout2005_mod_probit <- stan_model("stan/probit.stan")
```
```{r results='asis',echo=FALSE}
turnout2005_mod_probit
```


```{r turnout2005_fit_logit,results='hide'}
turnout2005_fit_logit <- sampling(turnout2005_mod_logit, data = turnout2005_data)
```
```{r}
turnout2005_fit_logit
```

```{r turnout2005_fit_probit,results='hide'}
turnout2005_fit_probit <- 
  sampling(turnout2005_mod_probit,
           data = turnout2005_data)
```
```{r}
turnout2005_fit_probit
```

These models can also be estimated with the `r rpkg("rstanarm")` function `r rdoc("rstanarm", "stan_glm")`:
```{r turnout2005_fit_logit2,results='hide'}
turnout2005_fit_logit2 <- 
  stan_glm(y ~ closing * poly(educ, 2) + poly(age, 2) + south + govelec,
         family = binomial(),
         data = turnout2005)
```
```{r}
turnout2005_fit_logit2
```

For the probit model, the priors need to be reduced.
```{r turnout2005_fit_probit2,results='hide'}
turnout2005_fit_probit2 <-
  stan_glm(y ~ closing * poly(educ, 2) + poly(age, 2) + south + govelec,
         family = binomial(link = "probit"),
         prior_intercept = normal(location = 0, scale = 8, autoscale = TRUE),
         prior = normal(location = 0, scale = 1.5, autoscale = TRUE),
         data = turnout2005)
```
```{r}
turnout2005_fit_probit2
```


## Questions {-}

1. Is there any difference in the fit of the probit and logit?
2. How do these fits compare to using a generalized logit model?
