<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bayesian Model Examples</title>
  <meta name="description" content="Bayesian Model Examples">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Bayesian Model Examples" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Model Examples" />
  
  
  

<meta name="author" content="Jeffrey B. Arnold and Simon Jackman">


<meta name="date" content="2018-05-07">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="reagan.html">
<link rel="next" href="legislators.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dependencies"><i class="fa fa-check"></i>Dependencies</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colonophon"><i class="fa fa-check"></i>Colonophon</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="undervote.html"><a href="undervote.html"><i class="fa fa-check"></i><b>1</b> Undervoting for President, by Race: Difference in Two Binomial Proportions</a><ul>
<li class="chapter" data-level="" data-path="undervote.html"><a href="undervote.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cancer.html"><a href="cancer.html"><i class="fa fa-check"></i><b>2</b> Cancer: difference in two binomial proportions</a></li>
<li class="chapter" data-level="3" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html"><i class="fa fa-check"></i><b>3</b> A tibble: 2 x 3</a><ul>
<li class="chapter" data-level="3.1" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html#two-sample-binomial-model"><i class="fa fa-check"></i><b>3.1</b> Two Sample Binomial Model</a></li>
<li class="chapter" data-level="3.2" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html#binomial-logit-model-of-the-difference"><i class="fa fa-check"></i><b>3.2</b> Binomial Logit Model of the Difference</a></li>
<li class="chapter" data-level="3.3" data-path="a-tibble-2-x-3.html"><a href="a-tibble-2-x-3.html#questions"><i class="fa fa-check"></i><b>3.3</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="florida.html"><a href="florida.html"><i class="fa fa-check"></i><b>4</b> Florida: Learning About an Unknown Proportion from Survey Data</a></li>
<li class="chapter" data-level="5" data-path="turnout.html"><a href="turnout.html"><i class="fa fa-check"></i><b>5</b> Turnout: logit/probit models for binary data</a><ul>
<li class="chapter" data-level="5.1" data-path="turnout.html"><a href="turnout.html#data"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="turnout.html"><a href="turnout.html#logit-model"><i class="fa fa-check"></i><b>5.2</b> Logit Model</a></li>
<li class="chapter" data-level="5.3" data-path="turnout.html"><a href="turnout.html#probit-model"><i class="fa fa-check"></i><b>5.3</b> Probit Model</a></li>
<li class="chapter" data-level="5.4" data-path="turnout.html"><a href="turnout.html#rstanarm"><i class="fa fa-check"></i><b>5.4</b> rstanarm</a></li>
<li class="chapter" data-level="" data-path="turnout.html"><a href="turnout.html#questions-1"><i class="fa fa-check"></i>Questions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cosponsorship.html"><a href="cosponsorship.html"><i class="fa fa-check"></i><b>6</b> Cosponsorship: computing auxiliary quantities from MCMC output</a><ul>
<li class="chapter" data-level="6.1" data-path="cosponsorship.html"><a href="cosponsorship.html#model"><i class="fa fa-check"></i><b>6.1</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reagan.html"><a href="reagan.html"><i class="fa fa-check"></i><b>7</b> Reagan: linear regression with AR(1) disturbances</a><ul>
<li class="chapter" data-level="7.1" data-path="reagan.html"><a href="reagan.html#cochrane-orcuttprais-winsten"><i class="fa fa-check"></i><b>7.1</b> Cochrane-Orcutt/Prais-Winsten</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sophistication.html"><a href="sophistication.html"><i class="fa fa-check"></i><b>8</b> Political Sophistication: item-response modeling with mixed data types</a><ul>
<li class="chapter" data-level="8.1" data-path="sophistication.html"><a href="sophistication.html#data-1"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="sophistication.html"><a href="sophistication.html#model-1"><i class="fa fa-check"></i><b>8.2</b> Model</a></li>
<li class="chapter" data-level="8.3" data-path="sophistication.html"><a href="sophistication.html#estimation"><i class="fa fa-check"></i><b>8.3</b> Estimation</a></li>
<li class="chapter" data-level="8.4" data-path="sophistication.html"><a href="sophistication.html#questions-extensions"><i class="fa fa-check"></i><b>8.4</b> Questions / Extensions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="legislators.html"><a href="legislators.html"><i class="fa fa-check"></i><b>9</b> Legislators: Estimating Legislators’ Ideal Points From Voting Histories</a><ul>
<li class="chapter" data-level="9.1" data-path="legislators.html"><a href="legislators.html#identification"><i class="fa fa-check"></i><b>9.1</b> Identification</a></li>
<li class="chapter" data-level="9.2" data-path="legislators.html"><a href="legislators.html#th-senate"><i class="fa fa-check"></i><b>9.2</b> 109th Senate</a></li>
<li class="chapter" data-level="9.3" data-path="legislators.html"><a href="legislators.html#identification-by-fixing-legislators-ideal-points"><i class="fa fa-check"></i><b>9.3</b> Identification by Fixing Legislator’s Ideal Points</a></li>
<li class="chapter" data-level="9.4" data-path="legislators.html"><a href="legislators.html#identification-by-fixing-legislators-signs"><i class="fa fa-check"></i><b>9.4</b> Identification by Fixing Legislator’s Signs</a></li>
<li class="chapter" data-level="9.5" data-path="legislators.html"><a href="legislators.html#identification-by-discrimination-parameters-signs"><i class="fa fa-check"></i><b>9.5</b> Identification by Discrimination Parameters’ Signs</a></li>
<li class="chapter" data-level="9.6" data-path="legislators.html"><a href="legislators.html#questions-2"><i class="fa fa-check"></i><b>9.6</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="judges.html"><a href="judges.html"><i class="fa fa-check"></i><b>10</b> Judges: estimating the ideological locations of Supreme Court justices</a></li>
<li class="chapter" data-level="11" data-path="resistant.html"><a href="resistant.html"><i class="fa fa-check"></i><b>11</b> Resistant: Outlier-resistant regression via the Student’s <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="11.1" data-path="resistant.html"><a href="resistant.html#data-2"><i class="fa fa-check"></i><b>11.1</b> Data</a></li>
<li class="chapter" data-level="11.2" data-path="resistant.html"><a href="resistant.html#reparameterization-standard-deviation-instead-of-scale"><i class="fa fa-check"></i><b>11.2</b> Reparameterization: standard deviation instead of scale</a></li>
<li class="chapter" data-level="" data-path="resistant.html"><a href="resistant.html#questions-3"><i class="fa fa-check"></i>Questions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="uk92.html"><a href="uk92.html"><i class="fa fa-check"></i><b>12</b> House of Commons elections: modeling with the multivariate Student-<span class="math inline">\(t\)</span> density</a><ul>
<li class="chapter" data-level="12.1" data-path="uk92.html"><a href="uk92.html#questions-4"><i class="fa fa-check"></i><b>12.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="campaign.html"><a href="campaign.html"><i class="fa fa-check"></i><b>13</b> Pooling the Polls Over an Election Campaign</a><ul>
<li class="chapter" data-level="13.1" data-path="campaign.html"><a href="campaign.html#data-3"><i class="fa fa-check"></i><b>13.1</b> Data</a></li>
<li class="chapter" data-level="13.2" data-path="campaign.html"><a href="campaign.html#model-2"><i class="fa fa-check"></i><b>13.2</b> Model</a></li>
<li class="chapter" data-level="13.3" data-path="campaign.html"><a href="campaign.html#estimation-1"><i class="fa fa-check"></i><b>13.3</b> Estimation</a></li>
<li class="chapter" data-level="13.4" data-path="campaign.html"><a href="campaign.html#questions-5"><i class="fa fa-check"></i><b>13.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="aspirin.html"><a href="aspirin.html"><i class="fa fa-check"></i><b>14</b> Aspirin: Borrowing Strength via Hierarchical Modeling</a><ul>
<li class="chapter" data-level="14.1" data-path="aspirin.html"><a href="aspirin.html#non-centered-parameterization"><i class="fa fa-check"></i><b>14.1</b> Non-centered parameterization</a></li>
<li class="chapter" data-level="" data-path="aspirin.html"><a href="aspirin.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="corporatism.html"><a href="corporatism.html"><i class="fa fa-check"></i><b>15</b> Corporatism: Hierarchical model for economic growth</a></li>
<li class="chapter" data-level="16" data-path="unidentified.html"><a href="unidentified.html"><i class="fa fa-check"></i><b>16</b> Unidentified: Over-Parameterization of a Normal Mean</a></li>
<li class="chapter" data-level="17" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html"><i class="fa fa-check"></i><b>17</b> Engines: right-censored failure times</a><ul>
<li class="chapter" data-level="17.1" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html#data-4"><i class="fa fa-check"></i><b>17.1</b> Data</a></li>
<li class="chapter" data-level="17.2" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html#model-3"><i class="fa fa-check"></i><b>17.2</b> Model</a></li>
<li class="chapter" data-level="17.3" data-path="engines-right-censored-failure-times.html"><a href="engines-right-censored-failure-times.html#estimation-2"><i class="fa fa-check"></i><b>17.3</b> Estimation</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html"><i class="fa fa-check"></i><b>18</b> Truncation: How does Stan deal with truncation?</a><ul>
<li class="chapter" data-level="18.1" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html#stan-model"><i class="fa fa-check"></i><b>18.1</b> Stan Model</a></li>
<li class="chapter" data-level="18.2" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html#estimation-3"><i class="fa fa-check"></i><b>18.2</b> Estimation</a></li>
<li class="chapter" data-level="18.3" data-path="truncation-how-does-stan-deal-with-truncation.html"><a href="truncation-how-does-stan-deal-with-truncation.html#questions-6"><i class="fa fa-check"></i><b>18.3</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="genbeetles.html"><a href="genbeetles.html"><i class="fa fa-check"></i><b>19</b> Generalized Beetles: Generalizing Link Functions for Binomial GLMs</a><ul>
<li class="chapter" data-level="19.1" data-path="genbeetles.html"><a href="genbeetles.html#data-5"><i class="fa fa-check"></i><b>19.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="negbin.html"><a href="negbin.html"><i class="fa fa-check"></i><b>20</b> Negative Binomial: Estimating Homicides in Census Tracks</a></li>
<li class="chapter" data-level="21" data-path="multivarmissing.html"><a href="multivarmissing.html"><i class="fa fa-check"></i><b>21</b> Multivariate Missing Data</a><ul>
<li class="chapter" data-level="21.1" data-path="multivarmissing.html"><a href="multivarmissing.html#separate-regressions"><i class="fa fa-check"></i><b>21.1</b> Separate Regressions</a></li>
<li class="chapter" data-level="21.2" data-path="multivarmissing.html"><a href="multivarmissing.html#multivariate-normal"><i class="fa fa-check"></i><b>21.2</b> Multivariate Normal</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Model Examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sophistication" class="section level1">
<h1><span class="header-section-number">8</span> Political Sophistication: item-response modeling with mixed data types</h1>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;rstan&quot;</span>)</a></code></pre></div>
<div id="data-1" class="section level2">
<h2><span class="header-section-number">8.1</span> Data</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;PoliticalSophistication&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;bayesjackman&quot;</span>)</a></code></pre></div>
<p>As part of a survey of French public opinion, 2,148 respondents were
administered a series of 19 items assessing their knowledge of political
leaders, political institutions, constitutional provisions, and the policies of
the political parties <span class="citation">(Grunberg, Mayer, and Sniderman <a href="#ref-GrunbergMayerSniderman2002a">2002</a>)</span>.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> Each
response is coded “correct” (1) or “incorrect” (0), and is modeled via a
two-parameter item-response model, with a logistic link function; each
respondent’s level of political sophistication is the latent trait.</p>
<p>In addition, at the end of the thirty minute phone interview, the interviewer
assigned a score for each respondent’s level of political information (based on
their impressions of the respondents formed over the course of the entire
interview) on a zero to twenty scale. These responses are modeled via a linear
regression, with each respondent’s latent trait appearing as an unobserved
predictor, and an intercept specific to each interviewer (modeled
hierarchically in the code below). To uniquely orient the latent trait (higher
values corresponding to more political sophistication), the interviewer
ratings are constrained to positively discriminate with respect to the latent
trait (see the constraint on the prior for gamma).</p>
</div>
<div id="model-1" class="section level2">
<h2><span class="header-section-number">8.2</span> Model</h2>
<p>The survey data consists of 20 items, <span class="math inline">\(y_1, \dots, y_20\)</span>. The first 19 items, <span class="math inline">\(y_1, \dots, y_19\)</span> binary responses to political information questions.
The final item, <span class="math inline">\(y_20\)</span>, is a political sophistication score (0–20) assigned by the interviewer.</p>
<p>Let <span class="math inline">\(y_{i,j}\)</span> be the response of respondent <span class="math inline">\(i \in 1, \dots, N\)</span> to question <span class="math inline">\(j \in 1, \dots, 20\)</span>.
<span class="math display">\[
\begin{aligned}[t]
y_{i,j} &amp;\sim \mathsf{Bernoulli}(\mathsf{Logit}^{-1}(\beta_j \xi_i - \alpha_j))
\end{aligned}
\]</span>
for <span class="math inline">\(j \in 1, \dots, j\)</span>.
Item 20 is modeled as
<span class="math display">\[
\begin{aligned}[t]
y_{20,j} &amp;\sim \mathsf{Normal}(\theta_i, \sigma^2) , \\
\theta_i &amp;= \gamma \xi_i + \nu_{m[i]} .
\end{aligned}
\]</span>
Since the question is assigned by the interviewer, <span class="math inline">\(\theta_i\)</span> is a linear function of a the latent score of the respondent (<span class="math inline">\(\xi_i\)</span>) and an interviewer specific random effect, <span class="math inline">\(\nu_{m[i]}\)</span>, where <span class="math inline">\(m[i]\)</span> means that <span class="math inline">\(i\)</span> was interviewed by interviewer <span class="math inline">\(m \in 1, \dots, M\)</span>.
The interviewer effects are given a prior distribution,
<span class="math display">\[
\nu_m \sim \mathsf{Normal}(0, \tau)  .
\]</span></p>
<p>To fix scale and location invariances, the respondents’ abilities are given a standard normal distribution,
<span class="math display">\[
\xi_m \sim \mathsf{Normal}(0, 1) .
\]</span>
Since higher interviewer assessments should be associated with a higher latent political knowledge score, the rotation invariance is resolved by restricting the coefficient for the respondents to be positive,
<span class="math display">\[
\gamma \sim \mathsf{HalfNormal}(0, 2.5 s_z) .
\]</span>
The remaining parameters are assigned weakly informative priors.
<span class="math display">\[
\begin{aligned}[t]
\tau &amp;\sim \mathsf{HalfCauchy}(0, 5 s_{y_{20}}) , \\
\sigma &amp;\sim \mathsf{HalfCauchy}(0, 5 s_{y_{20}})  , \\
\delta &amp;\sim \mathsf{Normal}(10, 10 s_{y_{20}}) , \\
\beta_k &amp;\sim \mathsf{Normal}(0, 2.5) , \\
\alpha_k &amp;\sim \mathsf{Normal}(0, 10) .
\end{aligned}
\]</span>
where <span class="math inline">\(s_{y_{20}}\)</span> is the scale for <span class="math inline">\(y_20\)</span>.
We could use the empirical standard deviation of <span class="math inline">\(y_20\)</span>, or an a-priori measure.
A value of <span class="math inline">\(s_{y_{20}} = 21 / 4\)</span>, would place 95% of the mass of a normal distribution between 0 and 20.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">mod_sophistication &lt;-<span class="st"> </span><span class="kw">stan_model</span>(<span class="st">&quot;stan/sophistication.stan&quot;</span>)</a></code></pre></div>
<pre>
  <code class="stan">data {
  // number of respondents
  int N;
  // number of items
  int K;
  // binary responses
  int<lower = 0, upper = 1> y_bern[K, N];
  // interviewer overall rating
  vector[N] y_norm;
  // interviewers
  int J;
  int<lower = 1, upper = J> interviewer[N];
  // priors
  real alpha_loc;
  real<lower = 0.> alpha_scale;
  real beta_loc;
  real<lower = 0.> beta_scale;
  real<lower = 0.> gamma_scale;
  real<lower = 0.> sigma_scale;
  real<lower = 0.> tau_scale;
  real delta_loc;
  real delta_scale;
}
parameters {
  // respondent latent score
  vector[N] xi_raw;
  // item discrimination
  vector[K] beta;
  // item difficulty
  vector[K] alpha;
  // coefficient in interviewer rating
  real<lower = 0.> gamma;
  // error in interviewer rating
  real<lower = 0.> sigma;
  // interviewer random effects
  vector[J] nu;
  // location of interviewer random effects
  real delta;
  // scale of interviewer random effects
  real<lower = 0.> tau;
}
transformed parameters {
  // interviewer rating
  vector[N] theta;
  // abilities
  vector[N] xi;
  xi = (xi_raw - mean(xi_raw));
  // respondent latent score
  for (i in 1:N) {
    theta[i] = gamma * xi[i] + nu[interviewer[i]];
  }
}
model {
  // priors
  xi_raw ~ normal(0., 1.);
  beta ~ normal(beta_loc, beta_scale);
  alpha ~ normal(alpha_loc, alpha_scale);
  gamma ~ normal(0., gamma_scale);
  sigma ~ cauchy(0., sigma_scale);
  tau ~ cauchy(0., tau_scale);
  delta ~ normal(delta_loc, delta_scale);
  // binary responses
  for (k in 1:K) {
    y_bern[k] ~ bernoulli_logit(beta[k] * xi - alpha[k]);
  }
  // interviewer random effects
  nu ~ normal(delta, tau);
  // interviewer score
  y_norm ~ normal(theta, sigma);
}</code>
</pre>
</div>
<div id="estimation" class="section level2">
<h2><span class="header-section-number">8.3</span> Estimation</h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">y_scale &lt;-<span class="st"> </span><span class="dv">21</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2"></a>
<a class="sourceLine" id="cb65-3" data-line-number="3">data_sophistication &lt;-<span class="st"> </span><span class="kw">within</span>(<span class="kw">list</span>(), {</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">  y_bern &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(<span class="kw">select</span>(PoliticalSophistication, Q1<span class="op">:</span>Q19)))</a>
<a class="sourceLine" id="cb65-5" data-line-number="5">  N &lt;-<span class="st"> </span><span class="kw">ncol</span>(y_bern)</a>
<a class="sourceLine" id="cb65-6" data-line-number="6">  K &lt;-<span class="st"> </span><span class="kw">nrow</span>(y_bern)</a>
<a class="sourceLine" id="cb65-7" data-line-number="7">  y_norm &lt;-<span class="st"> </span>PoliticalSophistication<span class="op">$</span>Q20</a>
<a class="sourceLine" id="cb65-8" data-line-number="8">  interviewer &lt;-<span class="st"> </span>PoliticalSophistication<span class="op">$</span>interviewer</a>
<a class="sourceLine" id="cb65-9" data-line-number="9">  J &lt;-<span class="st"> </span><span class="kw">max</span>(interviewer)</a>
<a class="sourceLine" id="cb65-10" data-line-number="10">  <span class="co"># priors</span></a>
<a class="sourceLine" id="cb65-11" data-line-number="11">  sigma_scale &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>y_scale</a>
<a class="sourceLine" id="cb65-12" data-line-number="12">  xi_loc &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb65-13" data-line-number="13">  xi_scale &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb65-14" data-line-number="14">  alpha_loc &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb65-15" data-line-number="15">  alpha_scale &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb65-16" data-line-number="16">  beta_loc &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb65-17" data-line-number="17">  beta_scale &lt;-<span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb65-18" data-line-number="18">  gamma_scale &lt;-<span class="st"> </span><span class="fl">2.5</span> <span class="op">*</span><span class="st"> </span>y_scale</a>
<a class="sourceLine" id="cb65-19" data-line-number="19">  <span class="co"># priors for interviewer effects</span></a>
<a class="sourceLine" id="cb65-20" data-line-number="20">  tau_scale &lt;-<span class="st"> </span>y_scale</a>
<a class="sourceLine" id="cb65-21" data-line-number="21">  delta_loc &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb65-22" data-line-number="22">  delta_scale &lt;-<span class="st"> </span>y_scale</a>
<a class="sourceLine" id="cb65-23" data-line-number="23">})</a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">fit_sophistication &lt;-<span class="st"> </span><span class="kw">sampling</span>(mod_sophistication, <span class="dt">data =</span> data_sophistication, <span class="dt">init =</span> <span class="dv">0</span>, <span class="dt">chains =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="co">#&gt; SAMPLING FOR MODEL &#39;sophistication&#39; NOW (CHAIN 1).</span></a>
<a class="sourceLine" id="cb66-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb66-5" data-line-number="5"><span class="co">#&gt; Gradient evaluation took 0.003267 seconds</span></a>
<a class="sourceLine" id="cb66-6" data-line-number="6"><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 32.67 seconds.</span></a>
<a class="sourceLine" id="cb66-7" data-line-number="7"><span class="co">#&gt; Adjust your expectations accordingly!</span></a>
<a class="sourceLine" id="cb66-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb66-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb66-10" data-line-number="10"><span class="co">#&gt; Iteration:    1 / 2000 [  0%]  (Warmup)</span></a>
<a class="sourceLine" id="cb66-11" data-line-number="11"><span class="co">#&gt; Iteration:  200 / 2000 [ 10%]  (Warmup)</span></a>
<a class="sourceLine" id="cb66-12" data-line-number="12"><span class="co">#&gt; Iteration:  400 / 2000 [ 20%]  (Warmup)</span></a>
<a class="sourceLine" id="cb66-13" data-line-number="13"><span class="co">#&gt; Iteration:  600 / 2000 [ 30%]  (Warmup)</span></a>
<a class="sourceLine" id="cb66-14" data-line-number="14"><span class="co">#&gt; Iteration:  800 / 2000 [ 40%]  (Warmup)</span></a>
<a class="sourceLine" id="cb66-15" data-line-number="15"><span class="co">#&gt; Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></a>
<a class="sourceLine" id="cb66-16" data-line-number="16"><span class="co">#&gt; Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></a>
<a class="sourceLine" id="cb66-17" data-line-number="17"><span class="co">#&gt; Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></a>
<a class="sourceLine" id="cb66-18" data-line-number="18"><span class="co">#&gt; Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></a>
<a class="sourceLine" id="cb66-19" data-line-number="19"><span class="co">#&gt; Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></a>
<a class="sourceLine" id="cb66-20" data-line-number="20"><span class="co">#&gt; Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></a>
<a class="sourceLine" id="cb66-21" data-line-number="21"><span class="co">#&gt; Iteration: 2000 / 2000 [100%]  (Sampling)</span></a>
<a class="sourceLine" id="cb66-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb66-23" data-line-number="23"><span class="co">#&gt;  Elapsed Time: 238.869 seconds (Warm-up)</span></a>
<a class="sourceLine" id="cb66-24" data-line-number="24"><span class="co">#&gt;                97.5362 seconds (Sampling)</span></a>
<a class="sourceLine" id="cb66-25" data-line-number="25"><span class="co">#&gt;                336.405 seconds (Total)</span></a></code></pre></div>
</div>
<div id="questions-extensions" class="section level2">
<h2><span class="header-section-number">8.4</span> Questions / Extensions</h2>
<ol style="list-style-type: decimal">
<li>An alternative parameterization would place the political sophistication on the same 0-20 scale as <code>Q20</code>.</li>
<li>Model <code>Q20</code> as an ordinal variable instead of a continuous variable.</li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-GrunbergMayerSniderman2002a">
<p>Grunberg, Gérard, Nonna Mayer, and Paul M. Sniderman. 2002. <em>La Démocratie à L’épreuve : Une Nouvelle Approche de L’opinion Des Français</em>. Fnsp - Presse de la.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>Simon Jackman, “<a href="https://web-beta.archive.org/web/*/http://jackman.stanford.edu:80/mcmc/sophistication2002.odc">Political Sophistication: item-response modeling with mixed data types</a>”, <em>BUGS Examples</em>.<a href="sophistication.html#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reagan.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="legislators.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
